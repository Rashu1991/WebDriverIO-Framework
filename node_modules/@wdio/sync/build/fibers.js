"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Future = exports.default = void 0;

var _logger = _interopRequireDefault(require("@wdio/logger"));

var _context;

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const log = (0, _logger.default)('@wdio/sync');
let Fiber;
let Future;
exports.Future = Future;
global._HAS_FIBER_CONTEXT = false;

const origErrorFn = (_context = console).error.bind(_context);

const errors = [];

console.error = (...args) => errors.push(args);

try {
  Fiber = require('fibers');
  exports.Future = Future = require('fibers/future');
} catch (e) {
  log.debug('Couldn\'t load fibers package for Node v10 and above');
}

console.error = origErrorFn;

if (!Fiber || !Future) {
  throw new Error('No proper `fibers` package could be loaded. It might be not ' + 'supported with your current Node version. Please ensure to use ' + `only WebdriverIOs recommended Node versions.\n${errors.join('\n')}`);
}

var _default = Fiber;
exports.default = _default;